<!DOCTYPE html>
<html>
    <head>
        <title>Club Application Form</title>
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>

        <h1>Club Application Form</h1>

        <form id="signupForm">

        <fieldset form="pinfo">

            <legend>Personal Information</legend>

            <label>Student ID: <input type="number" id="studid" name="studid" required onblur="myFunction(this)"></label><br>
            <label>Full name: <input type="text" id="fname" name="fname" required onblur="myFunction(this)"></label><br>
            <label>Birthday: <input type="date" id="bday" name="bday" required onblur="myFunction(this)"></label><br>
            <label >Email address: <input type="text" id="email" name="email" required onblur="myFunction(this)"></label><br>
        </fieldset>

        <br>

        <fieldset form="ainfo">

            <legend>Application</legend>
            <label>Mobile phone: <input type="text" id="mphone" name="mphone" required onblur="myFunction(this)"></label><br>
            <label>Grade Level:
            <select name="grlevel" id="grlevel" required onblur="myFunction(this)">
                <option value="seven">7</option>
                <option value="eight">8</option>
                <option value="nine">9</option>
                <option value="ten">10</option>
                <option value="eleven">11</option>
                <option value="twelve">12</option>
            </select>
            </label><br>
            <label>Intern <input type="radio" name="residency" value="int" id="int" required onblur="myFunction(this)"></label>
            <label>Extern <input type="radio" name="residency" value="ext" id="ext" required onblur="myFunction(this)"></label><br>
            <label>Preferred Club/Organization:
            <select name="club" id="club" required onblur="myFunction(this)">
                <option value="bake">Bake Club</option>
                <option value="sing">Himig Agham</option>
                <option value="draw">Likha</option>
                <option value="nature">CARE</option>
                <option value="act">Kamalayan</option>
                <option value="badminton">Volant</option>
            </select>
            </label><br>
        </fieldset>
        <br>
            <label>Why do you want to join? <textarea id = "tArea" name="reason" rows ="4" cols="50" required onblur="myFunction(this)"></textarea></label><br>
            <input type="submit" value="Submit">
            <input type="reset" value="Reset">

            <button type="button" onclick="location.href='viewSignUps.html'"> View Signups</button>
        </form>

        <script>

            const KEY = 'clubSignups';

            function loadSignups() {
                const raw= localStorage.getItem(KEY);

                if (raw){
                    return JSON.parse(raw);
                }
                else{
                    return [];
                }
            }

            function saveSignups(signups) {
                localStorage.setItem(KEY, JSON.stringify(signups));
            }

            document.getElementById("signupForm").addEventListener("submit", function (event)) {
                event.preventDefault();
            }

            if (!confirm("Do you want to submit the form")) {
                return;
            }

            const signup = {
                studentId: document.getElementById("studid").value,
                fullname: document.getElementById("fname").value,
                birthday: document.getElementById("bday").value,
                email: document.getElementById("email").value,
                mobile: document.getElementById("mphone").value,
                grade: document.getElementById("grlevel").value,
                residency: document.querySelector('input[name="residency"]:checked').value,
                club: document.getElementById("club").value,
                reason: document.getElementById("reason").value
            };

            const signups = loadSignups();
            signups.push(signup);
            saveSignups(signups);

            alert("Signup succesfully saved")
            this.reset();
            
            function myFunction(field) {
                if(field.value === "") {
                    field.style.border = "2px solid red";
                }
                else {
                    field.style.border = "";
                }
            }

        </script>
    </body>
</html>